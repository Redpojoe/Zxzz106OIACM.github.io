<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=" media="screen" type="text/css">
    <link rel="stylesheet" href="/assets/css/print.css" media="print" type="text/css">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>GYS’s Blog for OI/ACM | Much to do,little done.Start a battle.</title>
<meta name="generator" content="Jekyll v3.8.3" />
<meta property="og:title" content="GYS’s Blog for OI/ACM" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Much to do,little done.Start a battle." />
<meta property="og:description" content="Much to do,little done.Start a battle." />
<link rel="canonical" href="http://localhost:4000/" />
<meta property="og:url" content="http://localhost:4000/" />
<meta property="og:site_name" content="GYS’s Blog for OI/ACM" />
<script type="application/ld+json">
{"name":"GYS’s Blog for OI/ACM","description":"Much to do,little done.Start a battle.","@type":"WebSite","url":"http://localhost:4000/","headline":"GYS’s Blog for OI/ACM","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>
    <header>
      <div class="inner">
        <a href="http://localhost:4000/">
          <h1>GYS's Blog for OI/ACM</h1>
        </a>
        <h2>Much to do,little done.Start a battle.</h2>
        
        
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1 id="test">Test</h1>

<h3 id="线段树模板">线段树模板</h3>

<pre><code class="language-C++">#include&lt;stdio.h&gt;
#include&lt;string.h&gt;
#define M 100005
#define LL long long
LL data[M],sum[M];
struct node {
	int L,R;
	LL add,sum; 
} tree[M*4];
void Build(int L,int R,int p) {
	tree[p].L=L,tree[p].R=R;
	tree[p].sum=tree[p].add=0;
	if(L==R)return;
	int mid=(L+R)&gt;&gt;1;
	Build(L,mid,2*p);
	Build(mid+1,R,2*p+1);
}
void Up(int p) {
	tree[p].sum=tree[2*p].sum+tree[2*p+1].sum;
}
void Down(int p) {
	if(tree[p].add==0)return;
	tree[2*p].sum+=tree[p].add*(tree[2*p].R-tree[2*p].L+1);
	tree[2*p].add+=tree[p].add;
	tree[2*p+1].sum+=tree[p].add*(tree[2*p+1].R-tree[2*p+1].L+1);
	tree[2*p+1].add+=tree[p].add;
	tree[p].add=0;
}
void Update(int L,int R,LL add,int p) {
	if(tree[p].L==L&amp;&amp;tree[p].R==R) {
		tree[p].sum+=(R-L+1)*add;
		tree[p].add+=add;
		return;
	}
	Down(p);
	int mid=(tree[p].L+tree[p].R)&gt;&gt;1;
	if(mid&gt;=R)Update(L,R,add,2*p);
	else if(mid&lt;L)Update(L,R,add,2*p+1);
	else {
		Update(L,mid,add,2*p);
		Update(mid+1,R,add,2*p+1);
	}
	Up(p);
}
LL Query(int L,int R,int p) {
	if(tree[p].L==L&amp;&amp;tree[p].R==R) {
		return tree[p].sum;
	}
	Down(p);
	int mid=(tree[p].L+tree[p].R)&gt;&gt;1;
	if(R&lt;=mid)return Query(L,R,2*p);
	else if(L&gt;mid)return Query(L,R,2*p+1);
	else  return Query(L,mid,2*p)+Query(mid+1,R,2*p+1);
}
int main() {
	int n,m,a,b,i;
	LL c;
	char str[10];
	while(scanf("%d %d",&amp;n,&amp;m)!=EOF) {
		Build(1,n,1);
		sum[0]=0;
		for( i=1; i&lt;=n; i++) {
			scanf("%lld",&amp;data[i]);
			sum[i]=sum[i-1]+data[i];
		}
		while(m--&amp;&amp;scanf("%s %d %d",str,&amp;a,&amp;b)) {
			if(str[0]=='Q') {
				printf("%lld\n",sum[b]-sum[a-1]+Query(a,b,1));
			} else {
				scanf("%lld",&amp;c);
				Update(a,b,c,1);
			}
		}
	}
	return 0;
}
</code></pre>

        </section>

        <aside id="sidebar">
          

          

          <p><a href="https://Zxzz106.github.io" target="blank">GYS's Website</a></p>
        </aside>
      </div>
    </div>

    
  </body>
</html>
